import{j as e}from"./ui-vendor-D57amxQA.js";import{u as E,r as c,c as q,g as B}from"./react-vendor-oV3x6oea.js";import{D as R,a as W,b as A,c as H,L as K,I as Q,d as J,p as O}from"./label-BTPr1wkG.js";import{h as D,B as p,M as Y,l as _,m as V,j as X}from"./game-memory-DPb6ehu5.js";import{L as Z}from"./game-logic-7iLXf8FT.js";import{M as ee}from"./game-math-DPaR67bD.js";import{W as se}from"./game-words-CvtCwrwg.js";import{Q as ae}from"./game-quiz-CZHqemXJ.js";import{C as k,b as te,c as re,a as G,R as le,F as ne}from"./RequireNameToggle-zKKXj35D.js";import{u as ie,S as oe,i as T}from"./game-speed-DXNH_Teb.js";const ce=({level:r,onComplete:l,onTimeUp:i})=>{var y,v;const{toast:a}=ie(),d=E(),[m,u]=c.useState(1),[t,j]=c.useState([]);c.useEffect(()=>{const s=localStorage.getItem("puzzleGameTeams");if(s)try{const o=JSON.parse(s).map(h=>({...h,score:0}));j(o)}catch(n){console.error("Error parsing teams from localStorage",n)}},[]),c.useEffect(()=>{t.length===0?a({title:"Team Competition Mode",description:"Set up teams in the competitive mode to play together!"}):a({title:"Teams Ready",description:`${t.length} teams with ${t.reduce((s,n)=>s+n.players.length,0)} players`})},[t,a]);const b=(s,n)=>{j(o=>o.map((h,C)=>C===s-1?{...h,score:h.score+n}:h))},f=()=>{if(m<t.length)u(s=>s+1);else{const s=Math.max(...t.map(o=>o.score)),n=t.filter(o=>o.score===s).map(o=>o.name);a({title:n.length>1?"It's a tie!":`${n[0]} wins!`,description:`Final scores: ${t.map(o=>`${o.name}: ${o.score}`).join(", ")}`}),l()}},N=()=>{d("/"),setTimeout(()=>{var s;(s=document.querySelector('[aria-label="Players"]'))==null||s.click()},100)};return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 space-y-8 max-w-4xl mx-auto",children:[e.jsxs(k,{className:"w-full",children:[e.jsx(te,{className:"bg-primary/10 pb-3",children:e.jsxs(re,{className:"text-center flex items-center justify-center gap-2",children:[e.jsx(D,{className:"h-6 w-6"}),"Multiplayer Competition"]})}),e.jsx(G,{className:"pt-6",children:t.length>0?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("h3",{className:"font-medium text-xl mb-3",children:["Current Team: ",(y=t[m-1])==null?void 0:y.name]}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Players:"}),e.jsx("ul",{className:"list-disc list-inside",children:(v=t[m-1])==null?void 0:v.players.map(s=>e.jsx("li",{children:s.name},s.id))})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(p,{onClick:()=>b(m,10),children:"+10 Points"}),e.jsx(p,{onClick:f,children:"Next Team"})]})]}):e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("p",{className:"text-lg",children:"This is a competitive mode where teams compete against each other."}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-lg mb-3",children:"How to play:"}),e.jsxs("ol",{className:"text-left list-decimal list-inside space-y-2",children:[e.jsx("li",{children:"First, set up your teams in the Players panel"}),e.jsx("li",{children:"Each team will have up to 4 players"}),e.jsx("li",{children:"You can drag and drop players between teams to organize as you want"}),e.jsx("li",{children:"Each team takes turns playing mini-games"}),e.jsx("li",{children:"Teams earn points based on their performance"}),e.jsx("li",{children:"The team with the most points at the end wins!"})]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs(p,{size:"lg",onClick:N,className:"gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Set Up Teams"]})})]})})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 w-full",children:t.length>0?t.map((s,n)=>e.jsx(k,{className:m===n+1?"border-primary":"border-primary/20",children:e.jsxs(G,{className:"p-4 text-center",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.score}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.players.length," players"]})]})},s.id)):Array.from({length:4}).map((s,n)=>e.jsx(k,{className:"opacity-40",children:e.jsxs(G,{className:"p-4 text-center",children:[e.jsxs("h3",{className:"font-medium",children:["Team ",n+1]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"No players"})]})},n))})]})},me=({categoryId:r,level:l,onComplete:i,onTimeUp:a,onBackToSelection:d,onGameStateChange:m})=>{switch((r==null?void 0:r.toLowerCase())||""){case"memory":return e.jsx(Y,{level:l,onComplete:i,onTimeUp:a});case"logic":return e.jsx(Z,{level:l,onComplete:i,onTimeUp:a},l.id);case"math":return e.jsx(ee,{level:l,onComplete:i,onTimeUp:a});case"words":return e.jsx(se,{level:l,onComplete:i,onTimeUp:a});case"quiz":return e.jsx(ae,{level:l,onComplete:i,onTimeUp:a});case"competitive":return e.jsx(ce,{level:l,onComplete:i,onTimeUp:a});case"speed":return e.jsx(oe,{level:l,onComplete:i,onTimeUp:a,onBackToSelection:d,onGameStateChange:m});default:return e.jsxs("div",{className:"text-center p-8",children:[e.jsx("h2",{className:"text-xl font-medium mb-4",children:"Неподдържана категория игра"}),e.jsxs("p",{children:['Категорията "',r,'" в момента не е имплементирана.']})]})}},de=({open:r,onSubmit:l,categoryName:i="игра"})=>{const[a,d]=c.useState(""),m=t=>{t.preventDefault(),a.trim()&&l(a.trim())},u=t=>{t.key==="Enter"&&a.trim()&&l(a.trim())};return e.jsx(R,{open:r,children:e.jsxs(W,{className:"max-w-md mx-auto",children:[e.jsx(A,{children:e.jsxs(H,{className:"text-center text-xl font-bold text-gray-800 flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-6 h-6 text-blue-500"}),"Въведете вашето име"]})}),e.jsx("div",{className:"py-6",children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"username",className:"text-sm font-medium text-gray-700",children:"Име на играча"}),e.jsx(Q,{id:"username",type:"text",value:a,onChange:t=>d(t.target.value),onKeyPress:u,placeholder:"Въведете вашето име...",className:"mt-1",autoFocus:!0,maxLength:20})]}),e.jsxs(p,{type:"submit",disabled:!a.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(V,{className:"w-5 h-5 mr-2"}),"Започни играта"]})]})})]})})},ve=()=>{const{categoryId:r,levelId:l}=q(),i=E(),a=B(),d=l?parseInt(l):0,[m,u]=c.useState(null),[t,j]=c.useState(!0),[b,f]=c.useState(null),[N,y]=c.useState(!0),[v,s]=c.useState(""),[n,o]=c.useState(()=>{const x=localStorage.getItem("requireUsernameForSolo");return x===null?!0:x==="true"}),[h,C]=c.useState(!1);c.useEffect(()=>{var x;if(r&&d)try{const w=(x=a.state)==null?void 0:x.customLevel;let S;w?S=w:S=J(r,d),S?(u({level:S,category:O.find($=>$.id===r)}),f(null)):(f(`Нивото ${d} в категория ${r} не беше намерено`),i("/"))}catch(w){console.error("Error loading game level:",w),f("Възникна грешка при зареждане на нивото")}j(!1)},[r,d,i,a.state]);const M=x=>{s(x),y(!1),localStorage.setItem("currentPlayerName",x)},L=()=>{localStorage.removeItem("currentPlayerName"),T()&&r==="speed"?(i("/game/speed/1",{replace:!0}),window.location.reload()):i("/")},P=()=>{},z=()=>{},I=()=>{T()&&r==="speed"&&window.location.reload()},F=x=>{C(x)};if(t)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Зареждане..."})})});if(b)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg text-center max-w-md",children:[e.jsx("div",{className:"text-xl font-semibold text-red-600 mb-4",children:"Грешка"}),e.jsx("div",{className:"text-gray-700 mb-6",children:b}),e.jsx(p,{onClick:L,variant:"outline",children:"Назад към началото"})]})});if(!m)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Зареждане..."})})});const{level:U,category:g}=m;return n&&(N||!v)&&!T()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg text-center max-w-md",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Подготвяне на играта..."})})}),e.jsx(de,{open:N,onSubmit:M,categoryName:(g==null?void 0:g.name)||"игра"})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"fixed top-4 right-4 z-50 flex items-center gap-2",children:[e.jsx(le,{}),e.jsx(ne,{})]}),e.jsx("div",{className:"flex justify-between items-center mb-4 h-16",children:e.jsxs("div",{className:"flex items-center gap-3",children:[!(T()&&r==="speed"&&h)&&e.jsx(p,{variant:"ghost",size:"icon",onClick:L,className:"rounded-full bg-white/20 hover:bg-white/30 text-gray-700 backdrop-blur-sm border border-white/20",children:e.jsx(X,{className:"h-5 w-5"})}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm border border-white/20",children:e.jsx("h1",{className:"text-lg font-bold text-gray-800",children:g==null?void 0:g.name})})]})}),e.jsx("div",{className:"bg-white/40 backdrop-blur-sm rounded-3xl shadow-xl border border-white/30 overflow-hidden",style:{height:"calc(100vh - 7rem)"},children:e.jsx("div",{className:"h-full flex flex-col",children:e.jsx("div",{className:"flex-1 bg-white/60 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-4 overflow-auto",children:e.jsx(me,{categoryId:r||"",level:U,onComplete:P,onTimeUp:z,onBackToSelection:I,onGameStateChange:F})})})})]})};export{ve as default};
