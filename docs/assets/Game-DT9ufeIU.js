import{j as e}from"./ui-vendor-D57amxQA.js";import{u as q,r as c,c as K,g as Q}from"./react-vendor-oV3x6oea.js";import{D as J,a as O,b as V,c as Y,L as _,I as X,d as Z,p as ee}from"./label-DvQulQWo.js";import{h as I,B as p,M as se,l as ae,m as te,j as U}from"./game-memory-Boi4oVcu.js";import{L as re}from"./game-logic-Bgzf9yKm.js";import{M as le}from"./game-math-v7lK4ZD4.js";import{W as ne}from"./game-words-DgGK1VmL.js";import{Q as ie}from"./game-quiz-CrFe8738.js";import{C as L,b as oe,c as ce,a as G,R as F,F as $}from"./RequireNameToggle-BrQjqVg8.js";import{u as de,i as A,S as me,a as f,g as xe}from"./game-speed-DD5NCGP6.js";const he=({level:r,onComplete:l,onTimeUp:i})=>{var v,y;const{toast:t}=de(),m=q(),[d,g]=c.useState(1),[a,b]=c.useState([]);c.useEffect(()=>{const s=localStorage.getItem("puzzleGameTeams");if(s)try{const o=JSON.parse(s).map(u=>({...u,score:0}));b(o)}catch(n){console.error("Error parsing teams from localStorage",n)}},[]),c.useEffect(()=>{a.length===0?t({title:"Team Competition Mode",description:"Set up teams in the competitive mode to play together!"}):t({title:"Teams Ready",description:`${a.length} teams with ${a.reduce((s,n)=>s+n.players.length,0)} players`})},[a,t]);const N=(s,n)=>{b(o=>o.map((u,k)=>k===s-1?{...u,score:u.score+n}:u))},j=()=>{if(d<a.length)g(s=>s+1);else{const s=Math.max(...a.map(o=>o.score)),n=a.filter(o=>o.score===s).map(o=>o.name);t({title:n.length>1?"It's a tie!":`${n[0]} wins!`,description:`Final scores: ${a.map(o=>`${o.name}: ${o.score}`).join(", ")}`}),l()}},w=()=>{m("/"),setTimeout(()=>{var s;(s=document.querySelector('[aria-label="Players"]'))==null||s.click()},100)};return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 space-y-8 max-w-4xl mx-auto",children:[e.jsxs(L,{className:"w-full",children:[e.jsx(oe,{className:"bg-primary/10 pb-3",children:e.jsxs(ce,{className:"text-center flex items-center justify-center gap-2",children:[e.jsx(I,{className:"h-6 w-6"}),"Multiplayer Competition"]})}),e.jsx(G,{className:"pt-6",children:a.length>0?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("h3",{className:"font-medium text-xl mb-3",children:["Current Team: ",(v=a[d-1])==null?void 0:v.name]}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Players:"}),e.jsx("ul",{className:"list-disc list-inside",children:(y=a[d-1])==null?void 0:y.players.map(s=>e.jsx("li",{children:s.name},s.id))})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(p,{onClick:()=>N(d,10),children:"+10 Points"}),e.jsx(p,{onClick:j,children:"Next Team"})]})]}):e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("p",{className:"text-lg",children:"This is a competitive mode where teams compete against each other."}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-lg mb-3",children:"How to play:"}),e.jsxs("ol",{className:"text-left list-decimal list-inside space-y-2",children:[e.jsx("li",{children:"First, set up your teams in the Players panel"}),e.jsx("li",{children:"Each team will have up to 4 players"}),e.jsx("li",{children:"You can drag and drop players between teams to organize as you want"}),e.jsx("li",{children:"Each team takes turns playing mini-games"}),e.jsx("li",{children:"Teams earn points based on their performance"}),e.jsx("li",{children:"The team with the most points at the end wins!"})]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs(p,{size:"lg",onClick:w,className:"gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Set Up Teams"]})})]})})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 w-full",children:a.length>0?a.map((s,n)=>e.jsx(L,{className:d===n+1?"border-primary":"border-primary/20",children:e.jsxs(G,{className:"p-4 text-center",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s.score}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.players.length," players"]})]})},s.id)):Array.from({length:4}).map((s,n)=>e.jsx(L,{className:"opacity-40",children:e.jsxs(G,{className:"p-4 text-center",children:[e.jsxs("h3",{className:"font-medium",children:["Team ",n+1]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"No players"})]})},n))})]})},B=({categoryId:r,level:l,onComplete:i,onTimeUp:t,onBackToSelection:m,onGameStateChange:d})=>{const g=(r==null?void 0:r.toLowerCase())||"",a=A();switch(g){case"memory":return e.jsx(se,{level:l,onComplete:i,onTimeUp:t});case"logic":return e.jsx(re,{level:l,onComplete:i,onTimeUp:t},l.id);case"math":return e.jsx(le,{level:l,onComplete:i,onTimeUp:t});case"words":return e.jsx(ne,{level:l,onComplete:i,onTimeUp:t});case"quiz":return e.jsx(ie,{level:l,onComplete:i,onTimeUp:t});case"competitive":return e.jsx(he,{level:l,onComplete:i,onTimeUp:t});case"speed":return e.jsx(me,{level:l,onComplete:i,onTimeUp:t,onBackToSelection:m,onGameStateChange:d,isLandscapeMode:a});default:return e.jsxs("div",{className:"text-center p-8",children:[e.jsx("h2",{className:"text-xl font-medium mb-4",children:"Неподдържана категория игра"}),e.jsxs("p",{children:['Категорията "',r,'" в момента не е имплементирана.']})]})}},ue=({open:r,onSubmit:l,categoryName:i="игра"})=>{const[t,m]=c.useState(""),d=a=>{a.preventDefault(),t.trim()&&l(t.trim())},g=a=>{a.key==="Enter"&&t.trim()&&l(t.trim())};return e.jsx(J,{open:r,children:e.jsxs(O,{className:"max-w-md mx-auto",children:[e.jsx(V,{children:e.jsxs(Y,{className:"text-center text-xl font-bold text-gray-800 flex items-center justify-center gap-2",children:[e.jsx(ae,{className:"w-6 h-6 text-blue-500"}),"Въведете вашето име"]})}),e.jsx("div",{className:"py-6",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"username",className:"text-sm font-medium text-gray-700",children:"Име на играча"}),e.jsx(X,{id:"username",type:"text",value:t,onChange:a=>m(a.target.value),onKeyPress:g,placeholder:"Въведете вашето име...",className:"mt-1",autoFocus:!0,maxLength:20})]}),e.jsxs(p,{type:"submit",disabled:!t.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{className:"w-5 h-5 mr-2"}),"Започни играта"]})]})})]})})},Te=()=>{const{categoryId:r,levelId:l}=K(),i=q(),t=Q(),m=l?parseInt(l):0,[d,g]=c.useState(null),[a,b]=c.useState(!0),[N,j]=c.useState(null),[w,v]=c.useState(!0),[y,s]=c.useState(""),[n,o]=c.useState(()=>{const x=localStorage.getItem("requireUsernameForSolo");return x===null?!0:x==="true"}),[u,k]=c.useState(!1);c.useEffect(()=>{var x;if(r&&m)try{const S=(x=t.state)==null?void 0:x.customLevel;let T;S?T=S:T=Z(r,m),T?(g({level:T,category:ee.find(H=>H.id===r)}),j(null)):(j(`Нивото ${m} в категория ${r} не беше намерено`),i("/"))}catch(S){console.error("Error loading game level:",S),j("Възникна грешка при зареждане на нивото")}b(!1)},[r,m,i,t.state]);const R=x=>{s(x),v(!1),localStorage.setItem("currentPlayerName",x)},C=()=>{localStorage.removeItem("currentPlayerName"),f()&&r==="speed"?(i("/game/speed/1",{replace:!0}),window.location.reload()):i("/")},M=()=>{},P=()=>{},z=()=>{f()&&r==="speed"&&window.location.reload()},D=x=>{k(x)};if(a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Зареждане..."})})});if(N)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg text-center max-w-md",children:[e.jsx("div",{className:"text-xl font-semibold text-red-600 mb-4",children:"Грешка"}),e.jsx("div",{className:"text-gray-700 mb-6",children:N}),e.jsx(p,{onClick:C,variant:"outline",children:"Назад към началото"})]})});if(!d)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Зареждане..."})})});const{level:E,category:h}=d;if(n&&(w||!y)&&!f())return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/60 backdrop-blur-sm p-8 rounded-3xl shadow-lg text-center max-w-md",children:e.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Подготвяне на играта..."})})}),e.jsx(ue,{open:w,onSubmit:R,categoryName:(h==null?void 0:h.name)||"игра"})]});const W=A();return xe(),W?e.jsxs("div",{className:"pwa-landscape-container bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200",children:[e.jsxs("div",{className:"pwa-landscape-sidebar bg-white/20 backdrop-blur-sm border-r border-white/30 p-3 flex flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[!(f()&&r==="speed"&&u)&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:C,className:"self-start rounded-lg bg-white/20 hover:bg-white/30 text-gray-700 backdrop-blur-sm border border-white/20",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Назад"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm px-3 py-2 rounded-lg shadow-sm border border-white/20",children:e.jsx("h1",{className:"text-sm font-bold text-gray-800 text-center",children:h==null?void 0:h.name})})]}),e.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[e.jsx(F,{className:"text-xs"}),e.jsx($,{className:"self-start"})]}),e.jsx("div",{className:"flex-1"})]}),e.jsx("div",{className:"pwa-landscape-main",children:e.jsx("div",{className:"pwa-landscape-game-area bg-white/40 backdrop-blur-sm m-2 rounded-2xl shadow-xl border border-white/30",children:e.jsx("div",{className:"h-full w-full p-3 overflow-hidden",children:e.jsx(B,{categoryId:r||"",level:E,onComplete:M,onTimeUp:P,onBackToSelection:z,onGameStateChange:D})})})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 via-orange-200 to-orange-200 p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"fixed top-4 right-4 z-50 flex items-center gap-2",children:[e.jsx(F,{}),e.jsx($,{})]}),e.jsx("div",{className:"flex justify-between items-center mb-4 h-16",children:e.jsxs("div",{className:"flex items-center gap-3",children:[!(f()&&r==="speed"&&u)&&e.jsx(p,{variant:"ghost",size:"icon",onClick:C,className:"rounded-full bg-white/20 hover:bg-white/30 text-gray-700 backdrop-blur-sm border border-white/20",children:e.jsx(U,{className:"h-5 w-5"})}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm border border-white/20",children:e.jsx("h1",{className:"text-lg font-bold text-gray-800",children:h==null?void 0:h.name})})]})}),e.jsx("div",{className:"bg-white/40 backdrop-blur-sm rounded-3xl shadow-xl border border-white/30 overflow-hidden",style:{height:"calc(100vh - 7rem)"},children:e.jsx("div",{className:"h-full flex flex-col",children:e.jsx("div",{className:"flex-1 bg-white/60 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-4 overflow-auto",children:e.jsx(B,{categoryId:r||"",level:E,onComplete:M,onTimeUp:P,onBackToSelection:z,onGameStateChange:D})})})})]})};export{Te as default};
